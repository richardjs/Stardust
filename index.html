<!doctype html>
<html>
	<head>
		<meta charset="utf8">
		<style>
			body{
				margin: 0px;
			}
		</style>
	</head>
	<body>
		<img id="particleImg" src="img/smoke3.png" style="display: none;">
		<script src="js/stardust.js"></script>
		<script>
		window.addEventListener('load', function(){
			var canvas = document.createElement('canvas');
			var ctx = canvas.getContext('2d');
			canvas.width = window.innerWidth;
			canvas.height = window.innerHeight;
			document.body.appendChild(canvas);

			var stardust = new Stardust();
			canvas.addEventListener('mousedown', function(event){
				var x = event.clientX;
				var y = event.clientY;

				stardust.add(x, y, {
						image: document.getElementById('particleImg'),
						width: 0,
						height: 0,
						ttl: 500,
						emitCount: 30,
						emitInterval: 100,
						particleTTL: 1000,
						particleVelocity: function(t){
							var angle = Math.PI*2*Math.random();
							var speed = 100*Math.random();
							return {
								x: Math.cos(angle) * speed,
								y: Math.sin(angle) * speed
							}
						},
						opacity: function(){
							return function(t){
								return (Math.max(1000-t, 0))/1000
							}
						}
					}
				);
			});

			var lastTime = 0;
			function frame(time){
				var delta = time - lastTime;
				lastTime = time;
				
				ctx.fillStyle = '#001';
				ctx.fillRect(0, 0, canvas.width, canvas.height);
			
				stardust.update(delta);
				stardust.render(canvas, ctx);

				requestAnimationFrame(frame);
			}
			requestAnimationFrame(frame);
		});
		</script>
	</body>
</html>
